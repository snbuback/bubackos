# Architecture

The kernel consist of three layers:
1. HAL (there is no relationship with Linux HAL): responsible to handle basic hardware functionality to the kernel,
like timers, context switch, hardware events, locks
2. Core: provides the basic kernel functionality: creation of tasks, handle the tasks queue/priority, memory management and IPC
3. Platform loaders (or just Loaders): provides platform specific funcionality (still pending of definition)

Core and HAL comunicates using regular function calls.
The communication between Loader and the Core (there is no direct access to HAL) is using the IPC.


## HAL

time_t hal_current_time();
bool hal_lock(lock_t lock);
void hal_unlock(lock_t lock);

These functions are #define to the real function name, to make easy write kernel tests and mock them.

* Missing basic driver functionalities like console, keyboard, block disk etc...

### Minimium hardware functionality
* Task switch
* Timer
* Memory Paging/Memory isolation

## Core

void kernel_main();
task_t* get_available_tasks(): list of Task (first version always returning 1 task)
publish_hardware_event(...???)


## System events
These events are generated by the kernel or by the hardware layer

General system failure
Division by zero

# Project structure

|- src
   |--- hal
        |--- include
             |--- hal
                  |--- *.h
        |--- x86_64
             |--- boot.S
             |--- hal.c
        |--- multiboot.c
        |--- multiboot.S
   |--- core
        |--- include
             |--- core
                  |--- *.h
        |--- kernel.c
        |--- memory_management.c
        |--- page_management.c
        |--- logging.c
        |--- console.c
   |--- loader
        |--- include
             |--- loader
                  |--- *.h


