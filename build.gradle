/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */
allprojects {

}

subprojects {
    version = '0.1'
}


task prepareIso(type: Copy, dependsOn: ':kernel:build') {
    from('loader/boot')
    from('kernel/build/exe/kernel/kernel') {
        rename 'kernel', 'boot/kernel.bin'
    }
    into "$project.buildDir/loader"
}

task iso(type:Exec, dependsOn: prepareIso) {
    description 'Build the kernel image'
    // outputs = file("$project.buildDir/loader.iso")

    // commandLine "/bin/bash", "-c", "mkdir -p build/loader && cp -a loader/boot build/loader && cp kernel/build/exe/kernel/kernel build/loader/boot/kernel.bin && \
    // grub-mkrescue -o build/loader.iso build/loader"
    commandLine "grub-mkrescue", "-o", "build/loader.iso", "build/loader"

}